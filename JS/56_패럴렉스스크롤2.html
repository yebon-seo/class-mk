<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>패럴렉스스크롤</title>
  <!--폰트어썸 CDN-->
  <script src="https://kit.fontawesome.com/632d3e2496.js" crossorigin="anonymous"></script>
  <style>
    *{
      margin:0; 
      padding:0;
      box-sizing: border-box;
      user-select: none;/*text드래그 금지*/
    }
    ul{list-style:none}
    a{text-decoration: none;}

    header{
      width:100%;
      display:flex;
      align-items: center;
      justify-content: space-between;
      padding:20px 80px;
    }
    .logo a{
      font-size:40px;
      color:#111;
      transition: color 0.2s;
    }
    .toggle{
      font-size:30px;
      color:#111;
      transition: color 0.2s;
    }
    .logo a:hover{color:#ff3156;}
    .toggle:hover{color:#ff3156;}

    section{
      width:1200px;
      margin:auto;
    }
    article{
      width:100%;
      padding:60px 10px;
      display:flex;
      align-items: center;
    }
    .imgBox{/*이미지의 특정부분만 보여지도록 높이를 440px로 설정*/
      width:680px;
      height:440px;
      position:relative;
      overflow:hidden;
    }
    .image{/*이미지가 들어갈 요소*/
      width:100%;
      height:800px;
      position:absolute;
      bottom:0; left:0;
    }
    article:nth-child(1) .image{background-image:url(images/parallax1.jpg);}
    article:nth-child(2) .image{background-image:url(images/parallax2.jpg);}
    article:nth-child(3) .image{background-image:url(images/parallax3.jpg);}
    article:nth-child(4) .image{background-image:url(images/parallax4.jpg);}
    article:nth-child(5) .image{background-image:url(images/parallax5.jpg);}

    .txt{
      padding-left:70px;
    }
    .txt p{
      font-size:12px;
      color:#767676;
      letter-spacing: 2px;
    }
    .txt h2{
      font-size:36px;
      color:#111;
      margin:30px 0 20px;
    }
    .txt a{
      font-size:14px;
      color:#111;
      font-weight: bold;
      transition: color 0.2s;
    }
    .txt i{
      font-size:40px;
      padding-left:20px;
      vertical-align: middle;
      transition:padding 0.2s;
    }
    .txt a:hover{color:#ff3156;}
    .txt a:hover i{padding-left:30px;}

    footer{
      width:100%;
      padding:100px 0;
      text-align: center;
      background-color:#111;
      color:#fff;
      font-size:20px;
    }
    /*cursor-effect*/
    .cursor_effect{
      width: 2rem; /*root 요소의 기본값의 배수 1rem = 16px*/
      height: 2rem;
      position: fixed;
      pointer-events: none; /*해당요소가 클릭이 되지 않도록*/
      z-index: 9999;
      /*큐빅베지어에서 효과보고 복사해온거임*/
      transition: transform 0.1s cubic-bezier(.18,.91,.47,.99);
    }
    /*마우스 커서가 이펙트의 중심에 오도록 설정*/
    .cursor_effect > .cursor_wrap {
      position: absolute;
      width: 100%;
      height: 100%;
      opacity: 0.25;
      transform: translate(-50%,-50%);
    }
    /*실제 커서 이펙트가 표시될 요소*/
    .cursor_effect .cursor_icon {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background-color: #888;
      top: 50%; left: 50%;
      transform: translate(-50%,-50%);
      transition: transform 0.2s, width 0.3s, height 0.3s;
     
    }

    /*커서 이펙트에 on클래스가 추가되면 이펙트 크기변경*/
    .cursor_effect.on .cursor_icon{
      width: 300%;
      height: 300%;
      box-shadow: 0 0 8px black;
    }

    /*마우스 클릭시 액티브 클래스 추가*/
    .cursor_effect .cursor_icon.active {
      transform: translate(-50%,-50%) scale(0.6);
    }
  </style>
</head>
<body>
  <!-- cursor effect -->
   <div class="cursor_effect">
    <div class="cursor_wrap">
      <div class="cursor_icon"></div>
    </div>
   </div>
  <header>
    <div class="logo">
      <a href="#">LOGO</a>
    </div>
    <a href="#" class="toggle">
      <i class="fas fa-bars"></i>
    </a>
  </header>
  <!--container-->
  <section>
    <!--a1-->
    <article>
      <div class="imgBox">
        <div class="image"></div>
      </div>
      <div class="txt">
        <p>PRODUCT DESIGN</p>
        <h2>
          Photography<br>
          collage ideas
        </h2>
        <a href="#">
          View Project
          <i class="far fa-arrow-alt-circle-right"></i>
        </a>
      </div>
    </article>
    <!--a2-->
    <article>
      <div class="imgBox">
        <div class="image"></div>
      </div>
      <div class="txt">
        <p>ILLUSTRATION</p>
        <h2>
          Beautiful Website<br>
          Interfaces
        </h2>
        <a href="#">
          View Project
          <i class="far fa-arrow-alt-circle-right"></i>
        </a>
      </div>
    </article>
    <!--a3-->
    <article>
      <div class="imgBox">
        <div class="image"></div>
      </div>
      <div class="txt">
        <p>TYPOGRAPHY, WEBSITE</p>
        <h2>
          App &amp; Digital
        </h2>
        <a href="#">
          View Project
          <i class="far fa-arrow-alt-circle-right"></i>
        </a>
      </div>
    </article>
    <!--a4-->
    <article>
      <div class="imgBox">
        <div class="image"></div>
      </div>
      <div class="txt">
        <p>BRANDING</p>
        <h2>
          Branding<br>
          Inspiragion
        </h2>
        <a href="#">
          View Project
          <i class="far fa-arrow-alt-circle-right"></i>
        </a>
      </div>
    </article>
    <!--a5-->
    <article>
      <div class="imgBox">
        <div class="image"></div>
      </div>
      <div class="txt">
        <p>EDITORIAL</p>
        <h2>
          Extreme<br>
          Programming
        </h2>
        <a href="#">
          View Project
          <i class="far fa-arrow-alt-circle-right"></i>
        </a>
      </div>
    </article>
  </section>

  <footer>
    <p>&copy; Untitled. All rights reserved.</p>
  </footer>

  <script>
    //cursor effect
    const cursorEffect = document.querySelector(".cursor_effect")
    const cursorIcon = document.querySelector(".cursor_icon")


    //문서 내에서 무브 이벤트 발생
    document.documentElement.addEventListener("mousemove",(e)=>{
      //각 변수에 스크롤 이동값을 제외한 마우스x,y축 위치값을 할당
      let posX = e.clientX;
      let posY = e.clientY;

      cursorEffect.style.transform = `translate(${posX}px,${posY}px)`
    })

    //a요소에 마우스를 올리면 커서 이펙트가 커지는 효과
    const anchors = document.querySelectorAll("a");
    anchors.forEach(anchor =>{
      anchor.addEventListener("mouseover",() => {
        cursorEffect.classList.add("on")
      }) 
      anchor.addEventListener("mouseout",() => {
        cursorEffect.classList.remove("on")
      }) 
    })

    document.documentElement.addEventListener("mousedown",() =>{
      cursorIcon.classList.add("active");
    })
    document.documentElement.addEventListener("mouseup",() =>{
      cursorIcon.classList.remove("active");
    })

 

    //페럴랙스 효과
    //window내에서 scroll이벤트 발생시 doScroll함수 호출
    window.addEventListener("scroll",doScroll);

    //doScroll함수 생성
    function doScroll(){
      //스크롤 이동값을 변수에 할당
      let scrollMove = window.scrollY;
      //article의 높이값(padding포함)을 변수에 할당
      let ht = document.querySelector("article").offsetHeight;

      //모든 article요소 선택
      const articles = document.querySelectorAll("article");

      //forEach문으로 article요소를 순회하면서 함수 실행 매개변수el로 순회하는 artlcle요소를 전달받음
      articles.forEach(el => {
        //element.getBoundingClientRect().top; //브라우저의 top위치에서 부터 해당 요소의 top위치를 구해주는 메서드

        //해당 article요소의 y축 절대 좌표값을 thisTop변수에 할당
        //y축 절대 좌표값 = 스크롤 이동값 + 요소의 top위치값
        let thisTop = scrollMove + el.getBoundingClientRect().top;

        //각 변수에 thisTop에 article의 높이 값을 뺀 값과 더한 값을 할당(각 요소에 스크롤 이벤트가 발생할 범위)
        let start = thisTop - ht;
        let end = thisTop + ht;

        //스크롤 이동값이 start변수 값보다 크고 end값보다는 작거나 같을때 코드가 실행 
        if(scrollMove > start && scrollMove <= end){
          //변수에 스크롤 이동값에서 start변수 값을 뺀 값을 할당
          let value = scrollMove - start;

          //해당 순번의 article의 자손인 .image요소를 선택하여 bottom속성값을 value변수값으로 설정 이때 이미지를 아래로 이동시키기 위해 -부호를 적용하고 value값에서 3을 나눠 스크롤 이동값보다 작은 값으로 이동하도록 설정
        el.querySelector(".image").style.bottom = -(value/3) + "px";
        }
      })
    }
    //doScroll함수 호출 = 페이지가 처음 로드되었을때 이미지의 위치를 초기화 하기 위해 호출
    doScroll();
  </script>
</body>
</html>